<?phpclass TagRoot{ 	/* *************** The attribute list *************** */	var $id;	var $incDate;	var $tag;	var $dbTable 	= "tag";	var $className 	= "Tag";	var $DB;	/* *************** Pattern constructor *************** */	function TagRoot(){		global $DB;		$this->id = 0;		$this->incDate = time();		$this->tag = '';		$this->DB = $DB;	}	/* *************** Setters *************** */	function setId($var){		$this->id = toInt($var);	}	function setIncDate($var){		$this->incDate = dateToInt($var);	}	function setTag($var){		$this->tag = toHtmlEnt($var);	}	/* *************** Getters *************** */	function getId(){		return $this->id;	}	function getIncDate(){		return $this->incDate;	}	function getTag(){		return $this->tag;	}	/* *************** Set Var From Form Values *************** */	function setFromForm(){		$this->setId(getVar("id"));		$this->setTag(getVar("tag"));	}	/* *************** Databse functions *************** */	function setFromRow($row){		$this->id = $row["id"];		$this->incDate = $row["incDate"];		$this->tag = $row["tag"];	}	function load($id){		$strSQL = "" . 			"SELECT * " . 			"FROM ".$this->dbTable." " . 			"WHERE 1=1 " . 			"AND id=$id " . 			"LIMIT 0,1"; 		$result = $this->DB->getObj("".$this->className." :: function load($id)",$strSQL); 		$row = mysql_fetch_array($result); 		$this->setFromRow($row); 	}	/** Get total of records given an where clause. */	function getTotal($where){		$strSQL = "" . 			"SELECT COUNT(id) AS total " . 			"FROM ".$this->dbTable." " . 			"WHERE 1=1 " . 			"$where " . 			";"; 		$result = $this->DB->getObj("".$this->className." :: function getTotal()",$strSQL); 		$row=mysql_fetch_array($result); 		$total=$row["total"]; 		return $total; 	}	function loadLimit($sub,$offset,$orderBy){		if($orderBy=="") $orderBy = "id DESC";		$strSQL = "" . 			"SELECT * " . 			"FROM ".$this->dbTable." " . 			"WHERE 1=1 " . 			"ORDER BY $orderBy " . 			"LIMIT $sub,$offset"; 		$result = $this->DB->getObj("".$this->className." :: function loadLimit($sub, $offset, $orderBy)",$strSQL); 		$all = Array(); 		$i	 = 0; 		while ($row=mysql_fetch_array($result)){ 			$all[$i] = new Tag(); 			$all[$i]->setFromRow($row); 			$i++; 		}		return $all; 	}	function loadAll($orderBy){		if($orderBy=="") $orderBy = "id DESC";		$strSQL = "" . 			"SELECT * " . 			"FROM ".$this->dbTable." " . 			"WHERE 1=1 " . 			"ORDER BY $orderBy " . 			""; 		$result = $this->DB->getObj("".$this->className." :: function loadAll($orderBy)",$strSQL); 		$all = Array(); 		$i	 = 0; 		while ($row=mysql_fetch_array($result)){ 			$all[$i] = new Tag(); 			$all[$i]->setFromRow($row); 			$i++; 		}		return $all; 	}	/* *************** Store functions *************** */	function store(){		if($this->id==0)			$this->storeObj();		else			$this->updateObj();	}	function storeObj(){		$strSQL = "" .			"INSERT IGNORE INTO ".$this->dbTable." " .			"(incDate,tag) " .			"VALUES (" . 				"".$this->incDate.",".				"'".$this->tag."'" .			")";		$this->id = $this->DB->exe("".$this->className." :: storeObj()",$strSQL); 	}	function updateObj(){		$strSQL = "" .			"UPDATE ".$this->dbTable." " .			"SET " . 				"tag = '".$this->tag."' " .			"WHERE 1=1 " . 			"AND id = ".$this->id." " . 			";";		$this->DB->exe("".$this->className." :: updateObj()",$strSQL); 	}	/* *************** Del functions *************** */	function del(){ 		if(toInt($this->id)>0){ 			$strSQL = "DELETE FROM ".$this->dbTable." WHERE id = ".$this->id .""; 			$this->DB->exe("".$this->className." :: function del(".$this->id.")",$strSQL); 		} 	} 	/* *************** Install functions *************** */	function install(){ 		$strSQL = "CREATE TABLE IF NOT EXISTS ".$this->dbTable." ( " . 			"id int unsigned NOT NULL auto_increment," . 			"`incDate` int(32) NOT NULL DEFAULT 0 , " . 			"`tag` varchar(255)   , " . 			"PRIMARY KEY  (id)," . 			"UNIQUE KEY id (id),".			"UNIQUE KEY tag (tag)".			"" . 		") TYPE=MyISAM;";		$this->DB->exe("".$this->className." :: function install()",$strSQL); 	} }?>