<?phpclass ClockTagRoot{ 	/* *************** The attribute list *************** */	var $id;	var $incDate;	var $clockId;	var $tagId;	var $dbTable 	= "clockTag";	var $className 	= "ClockTag";	var $DB;	/* *************** Pattern constructor *************** */	function ClockTagRoot(){		global $DB;		$this->id = 0;		$this->incDate = time();		$this->clockId = 0;		$this->tagId = 0;		$this->DB = $DB;	}	/* *************** Setters *************** */	function setId($var){		$this->id = toInt($var);	}	function setIncDate($var){		$this->incDate = dateToInt($var);	}	function setClockId($var){		$this->clockId = toInt($var);	}	function setTagId($var){		$this->tagId = toInt($var);	}	/* *************** Getters *************** */	function getId(){		return $this->id;	}	function getIncDate(){		return $this->incDate;	}	function getClockId(){		return $this->clockId;	}	function getTagId(){		return $this->tagId;	}	/* *************** Set Var From Form Values *************** */	function setFromForm(){		$this->setId(getVar("id"));		$this->setClockId(getVar("clockId"));		$this->setTagId(getVar("tagId"));	}	/* *************** Databse functions *************** */	function setFromRow($row){		$this->id = $row["id"];		$this->incDate = $row["incDate"];		$this->clockId = $row["clockId"];		$this->tagId = $row["tagId"];	}	function load($id){		$strSQL = "" . 			"SELECT * " . 			"FROM ".$this->dbTable." " . 			"WHERE 1=1 " . 			"AND id=$id " . 			"LIMIT 0,1"; 		$result = $this->DB->getObj("".$this->className." :: function load($id)",$strSQL); 		$row = mysql_fetch_array($result); 		$this->setFromRow($row); 	}	/** Get total of records given an where clause. */	function getTotal($where){		$strSQL = "" . 			"SELECT COUNT(id) AS total " . 			"FROM ".$this->dbTable." " . 			"WHERE 1=1 " . 			"$where " . 			";"; 		$result = $this->DB->getObj("".$this->className." :: function getTotal()",$strSQL); 		$row=mysql_fetch_array($result); 		$total=$row["total"]; 		return $total; 	}	function loadLimit($sub,$offset,$orderBy){		if($orderBy=="") $orderBy = "id DESC";		$strSQL = "" . 			"SELECT * " . 			"FROM ".$this->dbTable." " . 			"WHERE 1=1 " . 			"ORDER BY $orderBy " . 			"LIMIT $sub,$offset"; 		$result = $this->DB->getObj("".$this->className." :: function loadLimit($sub, $offset, $orderBy)",$strSQL); 		$all = Array(); 		$i	 = 0; 		while ($row=mysql_fetch_array($result)){ 			$all[$i] = new ClockTag(); 			$all[$i]->setFromRow($row); 			$i++; 		}		return $all; 	}	function loadAll($orderBy){		if($orderBy=="") $orderBy = "id DESC";		$strSQL = "" . 			"SELECT * " . 			"FROM ".$this->dbTable." " . 			"WHERE 1=1 " . 			"ORDER BY $orderBy " . 			""; 		$result = $this->DB->getObj("".$this->className." :: function loadAll($orderBy)",$strSQL); 		$all = Array(); 		$i	 = 0; 		while ($row=mysql_fetch_array($result)){ 			$all[$i] = new ClockTag(); 			$all[$i]->setFromRow($row); 			$i++; 		}		return $all; 	}	/* *************** Store functions *************** */	function store(){		if($this->id==0)			$this->storeObj();		else			$this->updateObj();	}	function storeObj(){		$strSQL = "" .			"INSERT IGNORE INTO ".$this->dbTable." " .			"(incDate,clockId,tagId) " .			"VALUES (" . 				"".$this->incDate.",".				"".$this->clockId.",".				"".$this->tagId."" .			")";		$this->id = $this->DB->exe("".$this->className." :: storeObj()",$strSQL); 	}	function updateObj(){		$strSQL = "" .			"UPDATE ".$this->dbTable." " .			"SET " . 				"clockId = ".$this->clockId.",".				"tagId = ".$this->tagId." " .			"WHERE 1=1 " . 			"AND id = ".$this->id." " . 			";";		$this->DB->exe("".$this->className." :: updateObj()",$strSQL); 	}	/* *************** Del functions *************** */	function del(){ 		if(toInt($this->id)>0){ 			$strSQL = "DELETE FROM ".$this->dbTable." WHERE id = ".$this->id .""; 			$this->DB->exe("".$this->className." :: function del(".$this->id.")",$strSQL); 		} 	} 	/* *************** Install functions *************** */	function install(){ 		$strSQL = "CREATE TABLE IF NOT EXISTS ".$this->dbTable." ( " . 			"id int unsigned NOT NULL auto_increment," . 			"`incDate` int(32) NOT NULL DEFAULT 0 , " . 			"`clockId` int(32) NOT NULL DEFAULT 0 , " . 			"`tagId` int(32) NOT NULL DEFAULT 0 , " . 			"PRIMARY KEY  (id)," . 			"UNIQUE KEY id (id)," . 			"UNIQUE KEY clocktagid (clockId,tagId)" . 		") TYPE=MyISAM;";		$this->DB->exe("".$this->className." :: function install()",$strSQL); 	} }?>